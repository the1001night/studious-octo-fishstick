# –¢–µ—Å—Ç—ã API

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è backend API.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ setup.js          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã (–ë–î)
‚îú‚îÄ‚îÄ unit.test.js      # Unit —Ç–µ—Å—Ç—ã (–±–µ–∑ –ë–î)
‚îú‚îÄ‚îÄ auth.test.js      # –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ users.test.js     # –¢–µ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ health.test.js    # –¢–µ—Å—Ç—ã health check —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ validation.test.js # –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ integration.test.js # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ README.md         # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
npm test
```

### –ó–∞–ø—É—Å–∫ —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π (watch mode)
```bash
npm run test:watch
```

### –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
```bash
npm run test:coverage
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
```bash
npx jest auth.test.js
npx jest users.test.js
npx jest health.test.js
npx jest validation.test.js
npx jest integration.test.js
```

## üß™ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`auth.test.js`)
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö email
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (`/me`)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

### üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`users.test.js`)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–¥–º–∏–Ω)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (–∞–¥–º–∏–Ω)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–¥–º–∏–Ω)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### ‚ù§Ô∏è Health Check (`health.test.js`)
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ (uptime, –ø–∞–º—è—Ç—å, –≤–µ—Ä—Å–∏—è)
- ‚úÖ –°—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —Å—á–µ—Ç—á–∏–∫–∏)
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ API —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (`validation.test.js`)
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: –∏–º—è, email, –ø–∞—Ä–æ–ª—å
- ‚úÖ –í—Ö–æ–¥: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è: —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`integration.test.js`)
- ‚úÖ –ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –í—Ö–æ–¥ ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí –í—ã—Ö–æ–¥
- ‚úÖ –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üìä –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ‚úÖ –¢–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ
```
‚úì –¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (25ms)
‚úì –¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –≤–æ–π—Ç–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ credentials (12ms)
```

### ‚ùå –¢–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è
```
‚úó –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  expect(received).toBe(expected)
  Expected: 400
  Received: 201
```

### üìà –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
```
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-------------------|---------|----------|---------|---------|-------------------
All files          |   85.5  |    80.2  |   90.1  |   85.7  |
 routes/auth.js    |   92.3  |    85.7  |   100   |   92.1  |
 models/User.js    |   88.2  |    75.0  |   85.7  |   87.5  |
 middleware/auth.js|   91.7  |    83.3  |   100   |   91.7  |
-------------------|---------|----------|---------|---------|-------------------
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
–¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç in-memory MongoDB, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `feature.test.js`
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `describe()` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `it()` –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `beforeEach()` –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–º–µ—Ä:
```javascript
describe('–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è', () => {
  beforeEach(async () => {
    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  });

  it('–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', async () => {
    const response = await request(app)
      .get('/api/new-feature')
      .expect(200);

    expect(response.body.success).toBe(true);
  });
});
```

## üêõ –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö
```javascript
console.log('–û—Ç–ª–∞–¥–∫–∞:', response.body);
```

### –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
```bash
npx jest -t "–¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å"
```

### Verbose —Ä–µ–∂–∏–º
```bash
npx jest --verbose
```

## üìã –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤

- ‚úÖ `auth.test.js` - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ `users.test.js` - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `health.test.js` - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã health check'–∏
- ‚úÖ `validation.test.js` - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ `integration.test.js` - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç in-memory MongoDB –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.
